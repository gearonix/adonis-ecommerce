(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6656,8471],{48471:function(e,s,a){"use strict";a.r(s),a.d(s,{DefaultChat:function(){return p}});var t=a(97458),r=a(52983),l=a(56477),n=a.n(l),o=a(23870),c=a(18212),_=a(32180),i=a.n(_),d=a(67986),m=a(43967),u=a(57287),f=a(98362),g=a(85927);let h=e=>{let{messages:s,userId:a,getMoreMessages:l,roomId:_}=e,i=(0,m.Ji)(_),d=(0,r.useRef)(),{subscribes:u}=(0,g._)();return(0,m.MQ)({callback:l,wrapperRef:i.containerRef,triggerRef:d}),(0,r.useEffect)(()=>{u.onAddMessage(()=>{i.scrollToBottom(),setTimeout(i.scrollToBottom,550)})},[]),(0,r.useEffect)(i.rememberContainerScroll,[s]),(0,t.jsxs)("div",{className:n().messages_block,children:[(0,t.jsxs)("div",{className:n().messages_wrapper,onScroll:i.onScroll,ref:i.containerRef,children:[(0,t.jsx)(c.sS,{when:s.length,children:(0,t.jsx)("div",{ref:d})}),s.map(e=>(0,t.jsx)(c.sS,{when:e.roomId===_,children:(0,t.jsx)(o.v0,{message:e,isMine:e.senderId===a})},e.messageId)),(0,t.jsx)("div",{ref:i.bottomRef})]}),(0,t.jsx)("div",{className:n().bottomWrapper,children:(0,t.jsx)(c.sS,{when:i.scrollBottomSize>100,children:(0,t.jsx)(o.aK,{onClick:i.scrollToBottom})})})]})},p=()=>{let e=(0,m.KS)(300),{t:s}=(0,f.$G)();return(0,t.jsx)(c.sS,{when:e,children:(0,t.jsxs)(c.xM,{className:n().default_container,children:[(0,t.jsx)("div",{className:n().default_chat_image,children:(0,t.jsx)(u.avz,{})}),(0,t.jsxs)("h2",{className:n().default_title,children:[s("Choose a chat or create a"),(0,t.jsx)(i(),{href:d._.USERS,children:(0,t.jsxs)("span",{children:[" ",s("new one")]})})]})]})})};s.default=h},55301:function(e,s,a){"use strict";a.d(s,{_:function(){return c},A:function(){return o}});var t=a(64425),r=a(63069),l=a(2410),n=a(19625);let o=(0,t.L3)("messenger/GET_ROOMS",async(e,s)=>{let{dispatch:a,extra:t,getState:o,rejectWithValue:c}=s,_=n.ce.userId(o()),i=await t.api.messenger.getRooms(_);if((0,r.VZ)(i))return c("An error occurred.");a(l._I.setRooms(i.data))}),c=(0,t.L3)("messenger/SELECT_ROOM",async(e,s)=>{let{roomId:a,page:t=0}=e,{dispatch:o,extra:c,getState:_}=s,i=n.ce.userId(_()),d=await c.api.messenger.selectRoom(a,i,t);(0,r.VZ)(d)||o(l._I.setMessages(d.data))})},56656:function(e,s,a){"use strict";a.r(s);var t=a(97458),r=a(52983),l=a(17287),n=a.n(l),o=a(21611),c=a(43967),_=a(64425),i=a(55301),d=a(18212),m=a(93074),u=a(2410),f=a(85927),g=a(19625),h=a(48471);let p=(0,r.memo)(()=>{let e=(0,_.I0)(),s=(0,_.v9)(u._5.messages),a=(0,_.v9)(u._5.selectedId),l=(0,_.v9)(g.ce.userId),p=(0,_.v9)(u._5.page),{actions:x,subscribes:j}=(0,f._)();(0,r.useEffect)(()=>{j.onAddMessage(s=>{e(u._I.addMessage(s)),x.makeMessagesRead(s)}),j.onMessagesRead(()=>{e(u._I.makeMessagesRead())})},[]),(0,c.El)(()=>{e(u._I.clearRoom()),x.subscribeToRoom(a),e(u._I.clearPage()),e((0,i._)({roomId:a}))},[a]);let w=(0,r.useCallback)(()=>{e(u._I.increasePage())},[]);return(0,r.useEffect)(()=>{a&&0!==p&&e((0,i._)({roomId:a,page:p}))},[p]),(0,t.jsx)("div",{className:n().messages_main,children:(0,t.jsxs)("div",{className:n().wrapper,children:[(0,t.jsxs)(d.sS,{when:a,children:[(0,t.jsx)(o.cF,{messages:s,userId:l,getMoreMessages:w,roomId:a}),(0,t.jsx)(m.Z,{})]}),(0,t.jsx)(d.sS,{when:!a,children:(0,t.jsx)(h.DefaultChat,{})})]})})});s.default=p},56477:function(e){e.exports={messages_block:"style_messages_block__gDwSV",messages_wrapper:"style_messages_wrapper__Bo_dp",scrollToBottom:"style_scrollToBottom__n1Lxx",default_container:"style_default_container__gMYZ_",bottomWrapper:"style_bottomWrapper__ClUl1",default_chat_image:"style_default_chat_image__W7LEu",default_title:"style_default_title__pTFnf"}},17287:function(e){e.exports={messages_main:"style_messages_main__UiS2u",wrapper:"style_wrapper__DSPKV"}}}]);